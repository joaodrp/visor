<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Visor::Common::Config
  
    &mdash; VISoR
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../';
  framesUrl = "../../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Visor.html" title="Visor (module)">Visor</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Common.html" title="Visor::Common (module)">Common</a></span></span>
     &raquo; 
    <span class="title">Config</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Module: Visor::Common::Config
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
      <dt class="r1">Includes:</dt>
      <dd class="r1"><span class='object_link'><a href="Exception.html" title="Visor::Common::Exception (module)">Exception</a></span></dd>
      
    
  
  
    <dt class="r2">Included in:</dt>
    <dd class="r2"><span class='object_link'><a href="../Auth/Server.html" title="Visor::Auth::Server (class)">Auth::Server</a></span>, <span class='object_link'><a href="../Meta/Server.html" title="Visor::Meta::Server (class)">Meta::Server</a></span></dd>
    
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">common/lib/common/config.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>The Config module provides a set of utility functions to manipulate
configuration files and Logging.</p>


  </div>
</div>
<div class="tags">
  

</div>
  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="DEFAULT_CONFIG_DIRS-constant" class="">DEFAULT_CONFIG_DIRS =
          <div class="docstring">
  <div class="discussion">
    
<p>Default possible configuration file directories</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='qwords_beg'>%w{</span><span class='tstring_content'>.</span><span class='words_sep'> </span><span class='tstring_content'>~/.visor</span><span class='words_sep'> </span><span class='tstring_content'>/etc/visor</span><span class='words_sep'>}</span></pre></dd>
      
        <dt id="DEFAULT_CONFIG_FILE-constant" class="">DEFAULT_CONFIG_FILE =
          <div class="docstring">
  <div class="discussion">
    
<p>Default configuration file name</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>visor-config.yml</span><span class='tstring_end'>'</span></span></pre></dd>
      
        <dt id="DEFAULT_LOG_PATH-constant" class="">DEFAULT_LOG_PATH =
          <div class="docstring">
  <div class="discussion">
    
<p>Default logs path</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>~/.visor/logs</span><span class='tstring_end'>'</span></span></pre></dd>
      
        <dt id="DEFAULT_LOG_DATETIME-constant" class="">DEFAULT_LOG_DATETIME =
          <div class="docstring">
  <div class="discussion">
    
<p>Default log datetime format</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%Y-%m-%d %H:%M:%S</span><span class='tstring_end'>&quot;</span></span></pre></dd>
      
        <dt id="DEFAULT_LOG_LEVEL-constant" class="">DEFAULT_LOG_LEVEL =
          <div class="docstring">
  <div class="discussion">
    
<p>Default log level</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='const'>Logger</span><span class='op'>::</span><span class='const'>INFO</span></pre></dd>
      
        <dt id="CONFIG_TEMPLATE-constant" class="">CONFIG_TEMPLATE =
          <div class="docstring">
  <div class="discussion">
    
<p>Configuration file template</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>%q[</span><span class='tstring_content'>
# ===== Default always loaded configuration throughout VISOR sub-systems ======
default: &amp;default
    # Set the default log date time format
    log_datetime_format: &quot;%Y-%m-%d %H:%M:%S&quot;
    # Set the default log files directory path
    log_path: ~/.visor/logs
    # VISOR access and secret key credentials (from visor-admin command)
    access_key:
    secret_key:

# ================================ VISOR Auth =================================
visor_auth:
    # Merge default configurations
    &lt;&lt;: *default
    # Address and port to bind the server
    bind_host: 0.0.0.0
    bind_port: 4566
    # Backend connection string (backend://user:pass@host:port/database)
    #backend: mongodb://&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:27017/visor
    #backend: mysql://&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:3306/visor
    # Log file name (empty for STDOUT)
    log_file: visor-auth-server.log
    # Log level to start logging events (available: DEBUG, INFO)
    log_level: INFO

# ================================ VISOR Meta =================================
visor_meta:
    # Merge default configurations
    &lt;&lt;: *default
    # Address and port to bind the server
    bind_host: 0.0.0.0
    bind_port: 4567
    # Backend connection string (backend://user:pass@host:port/database)
    #backend: mongodb://&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:27017/visor
    #backend: mysql://&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:3306/visor
    # Log file name (empty for STDOUT)
    log_file: visor-meta-server.log
    # Log level to start logging events (available: DEBUG, INFO)
    log_level: INFO

# ================================ VISOR Image ================================
visor_image:
    # Merge default configurations
    &lt;&lt;: *default
    # Address and port to bind the server
    bind_host: 0.0.0.0
    bind_port: 4568
    # Log file name (empty for STDOUT)
    log_file: visor-api-server.log
    # Log level to start logging events (available: DEBUG, INFO)
    log_level: INFO

# =========================== VISOR Image Backends ============================
visor_store:
    # Default store (available: s3, lcs, cumulus, walrus, hdfs, file)
    default: file
    #
    # FileSystem store backend (file) settings
    #
    file:
        # Default directory to store image files in
        directory: ~/VMs/
    #
    # Amazon S3 store backend (s3) settings
    #
    s3:
        # The bucket to store images in, make sure it exists on S3
        bucket:
        # Access and secret key credentials, grab yours on your AWS account
        access_key:
        secret_key:
    #
    # Lunacloud LCS store backend (lcs) settings
    #
    lcs:
        # The bucket to store images in, make sure it exists on LCS
        bucket:
        # Access and secret key credentials, grab yours within Lunacloud
        access_key:
        secret_key:
    #
    # Nimbus Cumulus store backend (cumulus) settings
    #
    cumulus:
        # The Cumulus host address and port number
        host:
        port:
        # The bucket to store images in, make sure it exists on Cumulus
        bucket:
        # Access and secret key credentials, grab yours within Nimbus
        access_key:
        secret_key:
    #
    # Eucalyptus Walrus store backend (walrus) settings
    #
    walrus:
        # The Walrus host address and port number
        host:
        port:
        # The bucket to store images in, make sure it exists on Walrus
        bucket:
        # Access and secret key credentials, grab yours within Eucalyptus
        access_key:
        secret_key:
    #
    # Apache Hadoop HDFS store backend (hdfs) settings
    #
    hdfs:
        # The HDFS host address and port number
        host:
        port:
        # The bucket to store images in
        bucket:
        # Access credentials, grab yours within Hadoop
        username:
</span><span class='tstring_end'>]</span></span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#build_logger-class_method" title="build_logger (class method)">+ (Logger) <strong>build_logger</strong>(app_name, configs = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Build and return a Logger instance for a given VISOR subsystem, based on
configuration file options, which are validated through
#self#self.validate_logger.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_config_file-class_method" title="find_config_file (class method)">+ (nil, String) <strong>find_config_file</strong>(other_file = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Ordered search for a VISOR configuration file on default locations and
return the first matched.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_config-class_method" title="load_config (class method)">+ (Hash) <strong>load_config</strong>(scope = nil, other_file = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Looks for a VISOR configuration file through #self#self.find_config_file and
returns a hash with all configuration settings or just a subsystem scoped
settings.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  

  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="build_logger-class_method">
  
    + (<tt><span class='object_link'><a href="../../Logger.html" title="Logger (class)">Logger</a></span></tt>) <strong>build_logger</strong>(app_name, configs = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Build and return a Logger instance for a given VISOR subsystem, based on
configuration file options, which are validated through
Visor::Common::Config#self#self.validate_logger.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>app_name</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The VISOR subsystem app name to build a log for.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>configs</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a customizable set of options</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>configs</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">Optional</span>
          <span class="type">(<tt>Hash</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>configuration options to override config file ones.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Logger.html" title="Logger (class)">Logger</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A logger instance already properly configured.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Exception/ConfigError.html" title="Visor::Common::Exception::ConfigError (class)">ConfigError</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'common/lib/common/config.rb', line 192</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_build_logger'>build_logger</span><span class='lparen'>(</span><span class='id identifier rubyid_app_name'>app_name</span><span class='comma'>,</span> <span class='id identifier rubyid_configs'>configs</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_conf'>conf</span> <span class='op'>=</span> <span class='id identifier rubyid_configs'>configs</span> <span class='op'>||</span> <span class='id identifier rubyid_load_config'>load_config</span>

  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ConfigError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cannot locate 'default' configuration group.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_conf'>conf</span><span class='lbracket'>[</span><span class='symbol'>:default</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ConfigError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cannot locate '</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_app_name'>app_name</span><span class='rbrace'>}</span><span class='tstring_content'>' configuration group.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_conf'>conf</span><span class='lbracket'>[</span><span class='id identifier rubyid_app_name'>app_name</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_log_path'>log_path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_conf'>conf</span><span class='lbracket'>[</span><span class='symbol'>:default</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:log_path</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'>DEFAULT_LOG_PATH</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_log_datetime'>log_datetime</span> <span class='op'>=</span> <span class='id identifier rubyid_conf'>conf</span><span class='lbracket'>[</span><span class='symbol'>:default</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:log_datetime_format</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'>DEFAULT_LOG_DATETIME</span>
  <span class='id identifier rubyid_log_file'>log_file</span> <span class='op'>=</span> <span class='id identifier rubyid_conf'>conf</span><span class='lbracket'>[</span><span class='id identifier rubyid_app_name'>app_name</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:log_file</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'>STDOUT</span>
  <span class='id identifier rubyid_log_level'>log_level</span> <span class='op'>=</span> <span class='id identifier rubyid_conf'>conf</span><span class='lbracket'>[</span><span class='id identifier rubyid_app_name'>app_name</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:log_level</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'>DEFAULT_LOG_LEVEL</span>

  <span class='kw'>begin</span>
    <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_mkdir'>mkdir</span><span class='lparen'>(</span><span class='id identifier rubyid_log_path'>log_path</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_log_path'>log_path</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ConfigError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cannot create the 'default/log_path' directory: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='rbrace'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>begin</span>
    <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='id identifier rubyid_log_file'>log_file</span><span class='op'>==</span><span class='const'>STDOUT</span> <span class='op'>?</span> <span class='id identifier rubyid_log_file'>log_file</span> <span class='op'>:</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_log_path'>log_path</span><span class='comma'>,</span> <span class='id identifier rubyid_log_file'>log_file</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_log'>log</span> <span class='op'>=</span> <span class='const'>Logger</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='int'>5</span><span class='comma'>,</span> <span class='int'>1024</span><span class='op'>*</span><span class='int'>1024</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ConfigError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error while create the logger for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_output'>output</span><span class='rbrace'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='rbrace'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>begin</span>
    <span class='id identifier rubyid_log'>log</span><span class='period'>.</span><span class='id identifier rubyid_datetime_format'>datetime_format</span> <span class='op'>=</span> <span class='id identifier rubyid_log_datetime'>log_datetime</span>
    <span class='id identifier rubyid_log'>log</span><span class='period'>.</span><span class='id identifier rubyid_level'>level</span> <span class='op'>=</span> <span class='id identifier rubyid_get_log_level'>get_log_level</span><span class='lparen'>(</span><span class='id identifier rubyid_log_level'>log_level</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ConfigError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error while setting logger properties: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='rbrace'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_log'>log</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_config_file-class_method">
  
    + (<tt>nil</tt>, <tt>String</tt>) <strong>find_config_file</strong>(other_file = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Ordered search for a VISOR configuration file on default locations and
return the first matched.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other_file</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Other file to use instead of default config files.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>, <tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns nil if no valid config file was found or a string with the absolute
path to the found configuration file.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


150
151
152
153
154
155
156
157
158
159
160</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'common/lib/common/config.rb', line 150</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_config_file'>find_config_file</span><span class='lparen'>(</span><span class='id identifier rubyid_other_file'>other_file</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_other_file'>other_file</span>
    <span class='id identifier rubyid_file'>file</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_other_file'>other_file</span><span class='rparen'>)</span>
    <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_file'>file</span> <span class='op'>:</span> <span class='kw'>nil</span>
  <span class='kw'>else</span>
    <span class='const'>DEFAULT_CONFIG_DIRS</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_dir'>dir</span><span class='op'>|</span>
      <span class='id identifier rubyid_file'>file</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_expand_path'>expand_path</span><span class='lparen'>(</span><span class='id identifier rubyid_dir'>dir</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='const'>DEFAULT_CONFIG_FILE</span><span class='rparen'>)</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_file'>file</span> <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_config-class_method">
  
    + (<tt>Hash</tt>) <strong>load_config</strong>(scope = nil, other_file = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Looks for a VISOR configuration file through Visor::Common::Config#self#self.find_config_file and
returns a hash with all configuration settings or just a subsystem scoped
settings.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>scope</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Used to return just the settings about a specific subsystem.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>other_file</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Other file to use instead of default config files.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Global or scoped settings.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>RuntimeError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If there is no configuration files or if errors occur during parsing.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


172
173
174
175
176
177
178
179
180
181
182</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'common/lib/common/config.rb', line 172</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_load_config'>load_config</span><span class='lparen'>(</span><span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_other_file'>other_file</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_file'>file</span> <span class='op'>=</span> <span class='id identifier rubyid_find_config_file'>find_config_file</span><span class='lparen'>(</span><span class='id identifier rubyid_other_file'>other_file</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ConfigError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not found any configuration file.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_file'>file</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_content'>content</span> <span class='op'>=</span> <span class='const'>YAML</span><span class='period'>.</span><span class='id identifier rubyid_load_file'>load_file</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_symbolize_keys'>symbolize_keys</span>
  <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ConfigError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error while parsing the configuration file: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='rbrace'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_config'>config</span> <span class='op'>=</span> <span class='id identifier rubyid_scope'>scope</span> <span class='op'>?</span> <span class='id identifier rubyid_content'>content</span><span class='lbracket'>[</span><span class='id identifier rubyid_scope'>scope</span><span class='rbracket'>]</span> <span class='op'>:</span> <span class='id identifier rubyid_content'>content</span>
  <span class='id identifier rubyid_config'>config</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='label'>file:</span> <span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Sun Jun 24 14:52:28 2012 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.1 (ruby-1.9.3).
</div>

  </body>
</html>